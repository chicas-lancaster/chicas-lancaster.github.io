!function(exports){var valid_calendars=["google","ical","outlook","yahoo"],MS_IN_MINUTES=6e4,formatTime=function(date){return date.toISOString().replace(/-|:|\.\d+/g,"")},calculateEndTime=function(event){return formatTime(event.end?event.end:new Date(event.start.getTime()+event.duration*MS_IN_MINUTES))},calendarGenerators={google:function(event,class_name){var startTime=formatTime(event.start),endTime=calculateEndTime(event),href=encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(event.title||""),"&dates="+(startTime||""),"/"+(endTime||""),"&details="+(event.description||""),"&location="+(event.address||""),"&sprop=&sprop=name:"].join(""));return'<a class="'+class_name+'" target="_blank" href="'+href+'">Add to Google Calendar</a>'},yahoo:function(event,class_name){var eventDuration=event.end?(event.end.getTime()-event.start.getTime())/MS_IN_MINUTES:event.duration,yahooHourDuration=600>eventDuration?"0"+Math.floor(eventDuration/60):Math.floor(eventDuration/60)+"",yahooMinuteDuration=10>eventDuration%60?"0"+eventDuration%60:eventDuration%60+"",yahooEventDuration=yahooHourDuration+yahooMinuteDuration,st=formatTime(new Date(event.start-event.start.getTimezoneOffset()*MS_IN_MINUTES))||"",href=encodeURI(["http://calendar.yahoo.com/?v=60&view=d&type=20","&title="+(event.title||""),"&st="+st,"&dur="+(yahooEventDuration||""),"&desc="+(event.description||""),"&in_loc="+(event.address||"")].join(""));return'<a class="'+class_name+'" target="_blank" href="'+href+'">Add to Yahoo! Calendar</a>'},ics:function(event,class_name,calendarName){var startTime=formatTime(event.start),endTime=calculateEndTime(event),href=encodeURI("data:text/calendar;charset=utf8,"+["BEGIN:VCALENDAR","VERSION:2.0","BEGIN:VEVENT","URL:"+document.URL,"DTSTART:"+(startTime||""),"DTEND:"+(endTime||""),"SUMMARY:"+(event.title||""),"DESCRIPTION:"+(event.description||""),"LOCATION:"+(event.address||""),"END:VEVENT","END:VCALENDAR"].join("\n"));return'<a class="'+class_name+'" target="_blank" href="'+href+'">Add to '+calendarName+"</a>"},ical:function(event,class_name){return this.ics(event,class_name,"iCal")},outlook:function(event,class_name){return this.ics(event,class_name,"Outlook")}},generateCalendars=function(calendars,event,class_name){for(var generated_calendar_data={},i=0;i<calendars.length;i++)generated_calendar_data[calendars[i]]=calendarGenerators[calendars[i]](event,class_name);return generated_calendar_data},validParams=function(params){return void 0!==params.data&&void 0!==params.data.start&&(void 0!==params.data.end||void 0!==params.data.duration)},parseCalendars=function(params){var parsed_calendars=[];if(void 0===params.calendars)return valid_calendars;for(var i=0;i<params.calendars.length;i++)!params.calendars[i]in valid_calendars,parsed_calendars.push(params.calendars[i]);return parsed_calendars},generateMarkup=function(calendars,button_text,calendarId){var buttons_wrapper=document.createElement("div");return buttons_wrapper.id=calendarId,Object.keys(calendars).forEach(function(services){buttons_wrapper.innerHTML+=calendars[services]}),buttons_wrapper},getClassName=function(params){return params.options&&params.options.class_name?params.options.class_name:void 0},getButtonText=function(params){return params.options&&params.options.button_text?params.options.button_text:void 0},getOrGenerateCalendarId=function(params){return params.options&&params.options.id?params.options.id:Math.floor(1e6*Math.random())};exports.createCalendar=function(params){if(!validParams(params))return!1;var parsed_calendars=parseCalendars(params);return 0===parsed_calendars.length?!1:generateMarkup(generateCalendars(parsed_calendars,params.data,getClassName(params)),getButtonText(params),getOrGenerateCalendarId(params))}}(this);
//# sourceMappingURL=ouical.min.map